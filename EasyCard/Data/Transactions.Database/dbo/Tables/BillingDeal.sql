CREATE TABLE [dbo].[BillingDeal] (
    [BillingDealID]        UNIQUEIDENTIFIER NOT NULL,
    [BillingDealTimestamp] DATETIME2 (7)    NULL,
    [InitialTransactionID] UNIQUEIDENTIFIER NULL,
    [TerminalID]           UNIQUEIDENTIFIER NOT NULL,
    [MerchantID]           UNIQUEIDENTIFIER NOT NULL,
    [ProcessorID]          BIGINT           NULL,
    [AggregatorID]         BIGINT           NULL,
    [InvoicingID]          BIGINT           NULL,
    [MarketerID]           BIGINT           NULL,
    [Status]               SMALLINT         NOT NULL,
    [Currency]             SMALLINT         NOT NULL,
    [NumberOfPayments]     INT              NOT NULL,
    [TransactionAmount]    DECIMAL (19, 4)  NOT NULL,
    [TotalAmount]          DECIMAL (19, 4)  NOT NULL,
    [CurrentDeal]          INT              NULL,
    [CardNumber]           VARCHAR (20)     NULL,
    [CardExpiration]       VARCHAR (5)      NULL,
    [CardVendor]           VARCHAR (20)     NULL,
    [CardOwnerName]        NVARCHAR (100)   NULL,
    [CardOwnerNationalID]  VARCHAR (20)     NULL,
    [CardBin]              VARCHAR (10)     NULL,
    [CreditCardToken]      UNIQUEIDENTIFIER NOT NULL,
    [DealReference]        VARCHAR (50)     NULL,
    [DealDescription]      NVARCHAR (MAX)   NULL,
    [ConsumerEmail]        VARCHAR (50)     NULL,
    [ConsumerPhone]        VARCHAR (20)     NULL,
    [ConsumerID]           UNIQUEIDENTIFIER NULL,
    [Items]                NVARCHAR (MAX)   NULL,
    [BillingSchedule]      NVARCHAR (MAX)   NULL,
    [UpdatedDate]          DATETIME2 (7)    NULL,
    [UpdateTimestamp]      ROWVERSION       NULL,
    [Active]               BIT              DEFAULT (CONVERT([bit],(0))) NOT NULL,
    [CorrelationId]        VARCHAR (50)     NULL,
    [OperationDoneBy]      NVARCHAR (50)    DEFAULT (N'') NOT NULL,
    [OperationDoneByID]    UNIQUEIDENTIFIER NULL,
    [SourceIP]             VARCHAR (50)     NULL,
    CONSTRAINT [PK_BillingDeal] PRIMARY KEY CLUSTERED ([BillingDealID] ASC)
);

